"use strict";(self.webpackChunkgwiyeom_blog=self.webpackChunkgwiyeom_blog||[]).push([[8163],{1390:function(e,n,t){t.r(n),t.d(n,{Head:function(){return a.p},default:function(){return o}});var l=t(6540),r=t(8453);function c(e){const n=Object.assign({h1:"h1",p:"p",h2:"h2",h3:"h3",pre:"pre",code:"code",ol:"ol",li:"li"},(0,r.RP)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.h1,null,"배경"),"\n",l.createElement(n.p,null,"이벤트 와 기부 정보는 서로 역일 수 있는 key 는 member_id 입니다\n이벤트를 참여한 사람의 기부 정보도 보여주고 또한 참여한 이벤트도 보여달라는\n요청이 왔습니다"),"\n",l.createElement(n.h2,null,"WITH 절"),"\n",l.createElement(n.p,null,"join이 어려운 구조이며\n계층적/순차적인 계산하거나 중간 결과 재사용하는 경우"),"\n",l.createElement(n.p,null,"ex) 테이블 간 물리적 외래 키 연결은 없지만\nuser_id 같은 공통 키로 묶을 수 있는 경우"),"\n",l.createElement(n.h3,null,"예시"),"\n",l.createElement(n.p,null,"각 회원별로 총 주문 금액을 알고 싶고,\n총액이 1,000 이상인 회원만 보고 싶다."),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"WITH user_order_totals AS (\n  SELECT user_id, SUM(price) AS total_amount\n  FROM orders\n  GROUP BY user_id\n)\n\nSELECT *\nFROM user_order_totals\nWHERE total_amount >= 1000;\n")),"\n",l.createElement(n.h1,null,"문제"),"\n",l.createElement(n.p,null,"문제는 이벤트,이벤트참여정보,이벤트체택정보 3개 테이블을 left join 했더니\nmember_id 가 복수가 나왔고 기부 정보 또한 늘어나는 문제가 있었습니다"),"\n",l.createElement(n.p,null,"기부도 복수, 이벤트 참여도 복수라면 결과가 곱집합처럼 늘어났다\n단순히 join 과 with 으로 해결할 수 없고 더 복잡해졌다"),"\n",l.createElement(n.p,null,"결국 요청한 사용자가 기부를 많이한 기부자나,채택이 된 경우 등 보고 싶은 욕구로\n요청이 들어왔기 때문에 나눠서 쿼리 결과를 전달했다"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"'2025-03-25' 특정 날짜에 이벤트 참여자 리스트 (채택 여부 확인)"),"\n",l.createElement(n.li,null,"'2025-03-25' 특정 날짜에 이벤트 참여자의 기부 리스트"),"\n",l.createElement(n.li,null,"특정 회원의 기부 리스트"),"\n"))}var u=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.RP)(),e.components);return n?l.createElement(n,e,l.createElement(c,e)):c(e)},a=t(7292);function o(e){return l.createElement(a.A,e,l.createElement(u,e))}a.A}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-server-database-mysql-2025-03-26-mysql-with-mdx-7e5cb0ab46623f34db8a.js.map