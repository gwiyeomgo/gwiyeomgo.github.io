---
title: docker ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆ ì¤„ì´ê¸°
date: 2025-04-03
slug: "/infra/2025-04-02-infta-docker-image"
tags:
  - INFRA
  - 2025
---


docker images | grep {projectì´ë¦„}


# Docker Push ì‹¤íŒ¨: 413 Request Entity Too Large í•´ê²° ì‚¬ë¡€

## â—ï¸ë¬¸ì œ ìƒí™©

Docker ì´ë¯¸ì§€ ë¹Œë“œ í›„ `docker push` ê³¼ì •ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ ë°œìƒ:

```
error parsing HTTP 413 response body: invalid character '<' looking for beginning of value: "<html>...<h1>413 Request Entity Too Large</h1>...</html>"
```

### ì›ì¸

- Docker ì´ë¯¸ì§€ê°€ **500MB ì´ìƒ**ìœ¼ë¡œ ì»¤ì§
- Docker Registry ì•ë‹¨ì˜ **Nginx**ê°€ `client_max_body_size` ì œí•œìœ¼ë¡œ ì¸í•´ push ìš”ì²­ì„ ì°¨ë‹¨
- í•˜ì§€ë§Œ **Nginx ì„¤ì • ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•œ í™˜ê²½**ì´ì—ˆìŒ (`client_max_body_size` ìˆ˜ì • ë¶ˆê°€)

---

## âœ… í•´ê²° ë°©ë²•

### ì „ëµ: **Docker ì´ë¯¸ì§€ ìì²´ë¥¼ ê²½ëŸ‰í™”í•˜ì—¬ push í—ˆìš© ë²”ìœ„ ì•ˆìœ¼ë¡œ ì¤„ì´ê¸°**

### ì ìš©í•œ ìµœì í™” ë°©ë²•

1. **Base Image ë³€ê²½**

   - ê¸°ì¡´: `node:22`
   - ë³€ê²½: `node:22-alpine`
     â†’ Alpine ê¸°ë°˜ Node ì´ë¯¸ì§€ë¡œ ìš©ëŸ‰ ìµœì†Œí™” (ì•½ 30~50MB ìˆ˜ì¤€)

2. **ë©€í‹° ìŠ¤í…Œì´ì§€ Dockerfile ìœ ì§€**

   - Build ìŠ¤í…Œì´ì§€ì—ì„œë§Œ `yarn install` + `yarn build`
   - Runtime ìŠ¤í…Œì´ì§€ì—ëŠ” ë¹Œë“œëœ ê²°ê³¼ë¬¼ë§Œ ë³µì‚¬

3. **ëŸ°íƒ€ì„ ìŠ¤í…Œì´ì§€ì—ì„œ `yarn install --production` ì œê±°**

   - ëŒ€ì‹  Build ìŠ¤í…Œì´ì§€ì—ì„œ ì„¤ì¹˜ëœ `node_modules`ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬
   - ë¶ˆí•„ìš”í•œ ì¬ì„¤ì¹˜ ì œê±°ë¡œ ìš©ëŸ‰ ì ˆê°

### ìµœì¢… Dockerfile í•µì‹¬ ë¶€ë¶„

```Dockerfile
FROM node:22-alpine AS builder

WORKDIR /app
RUN corepack enable

COPY package.json yarn.lock* ./
RUN yarn install --production

COPY . .
RUN yarn build

FROM node:22-alpine

WORKDIR /app
RUN corepack enable

COPY package.json yarn.lock* ./
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/dist ./dist

EXPOSE 9010
CMD ["node", "dist/main"]
```

---

## ğŸ“¦ ê²°ê³¼

- ğŸ”§ ì´ë¯¸ì§€ ìš©ëŸ‰: **ì•½ 700MB â†’ 500MB ì´í•˜ë¡œ ê°ì†Œ**
- ğŸš« `413 Request Entity Too Large` ì˜¤ë¥˜ í•´ê²°
- âœ… ë³„ë„ ì¸í”„ë¼ ì„¤ì • ë³€ê²½ ì—†ì´ ë¬¸ì œ í•´ê²°

---

## ğŸ’¡ ê²°ë¡ 

Nginx ì„¤ì • ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•œ í™˜ê²½ì—ì„œëŠ” **ì´ë¯¸ì§€ ìì²´ë¥¼ ìŠ¬ë¦¼í•˜ê²Œ ìµœì í™”í•˜ëŠ” ê²ƒì´ ê°€ì¥ í˜„ì‹¤ì ì¸ í•´ê²°ì±…**ì´ë‹¤.

> ì‘ì€ ì´ë¯¸ì§€ëŠ” ë¹ ë¥¸ ë°°í¬, ì ì€ ë„¤íŠ¸ì›Œí¬ ì „ì†¡ëŸ‰, ë³´ì•ˆ ë…¸ì¶œ ìµœì†Œí™”ì—ë„ íš¨ê³¼ì ì…ë‹ˆë‹¤.
